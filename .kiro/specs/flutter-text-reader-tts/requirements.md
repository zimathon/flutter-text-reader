# Requirements Document

## Overview

書籍のテキストをVibeVoice TTSエンジンを使用して自然な音声で読み上げるFlutterモバイルアプリケーション。30秒早送りなどの高度な再生制御機能を搭載し、長時間の読書体験を快適にサポートする。

## Project Description (User Input)

Flutterアプリの構築を進めたい
書籍をテキスト形式として用意するのでを自動読み上げ機能
読み上げには <https://microsoft.github.io/VibeVoice/> を利用して
音声再生には早送り機能を設けたい、三〇秒先なども
とりあえずAndroidアプリで動けばいいです

## 機能要件

### 1. テキスト管理機能

**ユーザーストーリー**: 読者として、書籍のテキストを簡単にアプリに取り込み、管理したい

#### 受け入れ基準

- [ ] テキストファイル（.txt形式）のアップロード機能
  - ファイルピッカーからの選択
  - ドラッグ&ドロップ対応（タブレット）
  - 複数ファイルの一括アップロード
- [ ] 対応フォーマット
  - プレーンテキスト（.txt）
  - UTF-8、Shift-JIS、EUC-JP エンコーディング自動判定
  - .md（Markdown）
  - .rtf（リッチテキスト）対応
- [ ] アプリ内でテキストの直接入力・編集が可能
- [ ] 複数の書籍テキストの保存・管理
- [ ] 書籍リストの表示（タイトル、著者、最終読書位置、ファイルサイズ）
- [ ] テキストの削除機能
- [ ] インポート時の自動メタデータ抽出（ファイル名からタイトル推定）

### 2. 音声合成（TTS）機能

**ユーザーストーリー**: 読者として、自然で聞き取りやすい音声で書籍を聴きたい

#### 受け入れ基準

- [ ] VibeVoice APIとの連携（サーバーモード）
- [ ] テキストから音声への変換処理
- [ ] 音声生成状況の進捗表示
- [ ] エラー時の適切なフィードバック
- [ ] オフライン時の代替TTS（Android標準TTS）への自動切り替え

### 3. 音声再生制御

**ユーザーストーリー**: 読者として、音声再生を自由にコントロールしたい

#### 受け入れ基準

- [ ] 再生/一時停止機能
- [ ] 30秒早送り/巻き戻し機能
- [ ] 10秒早送り/巻き戻し機能（オプション）
- [ ] 再生速度調整（0.5x〜2.0x）
- [ ] 音量調整
- [ ] 現在の再生位置表示（時間/パーセンテージ）
- [ ] シークバーでの任意位置への移動

### 4. 読書進捗管理

**ユーザーストーリー**: 読者として、読書の進捗を記録し、続きから再開したい

#### 受け入れ基準

- [ ] 最後に再生した位置の自動保存
- [ ] アプリ再起動時の読書位置復元
- [ ] ブックマーク機能（複数箇所の保存）
- [ ] 読書履歴の表示
- [ ] 読了率の表示

### 5. ユーザーインターフェース

**ユーザーストーリー**: 読者として、直感的で使いやすい操作画面が欲しい

#### 受け入れ基準

- [ ] ホーム画面（書籍リスト表示）
- [ ] 読書画面（再生コントロール、テキスト表示）
- [ ] 設定画面（音声設定、表示設定）
- [ ] ダークモード対応
- [ ] 大きめのボタンで操作しやすいUI
- [ ] ジェスチャー操作（スワイプで早送り等）

## 非機能要件

### パフォーマンス要件

- **音声生成時間**: 1分のテキストに対して10秒以内での音声生成
- **アプリ起動時間**: 3秒以内
- **メモリ使用量**: 最大500MB以内
- **バッテリー消費**: バックグラウンド再生時も省電力動作

### 互換性要件

- **対象OS**: Android 7.0（API Level 24）以上
- **画面サイズ**: スマートフォン（4.7〜6.7インチ）対応
- **言語**: 日本語UI、日本語音声合成対応

### 品質要件

- **音声品質**: VibeVoice使用時は高品質（自然な抑揚、明瞭な発音）
- **安定性**: 連続8時間の再生でもクラッシュしない
- **データ保護**: 読書進捗データの確実な保存

### セキュリティ要件

- **通信**: VibeVoice APIとの通信はHTTPS必須
- **データ保存**: 個人データの暗号化保存
- **権限**: 必要最小限のAndroid権限のみ要求

### 制約事項

- **VibeVoice制限**:
  - 現状はサーバーモード（Python API）での実装
  - 将来的にWebAssembly版（0.5Bモデル）への移行を考慮
  - 大容量テキストは分割処理が必要（90分制限）
- **ネットワーク**: VibeVoice使用時はインターネット接続必須
- **ストレージ**: 音声キャッシュ用に最低1GBの空き容量推奨

## 将来の拡張性

- iOS版への展開
- VibeVoice 0.5B-Streamingモデルのオンデバイス実行
- PDF/EPUB形式のサポート
- クラウド同期機能
- 複数話者での朗読機能（会話文の識別）
